<div class="paths-container">
  <h2 class="title">Learning Paths</h2>

  <div class="actions-bar" *ngIf="isAdmin">
    <button class="add-btn" (click)="addNew()">+ Add New Path</button>
  </div>

  <!-- Learning Paths Carousel -->
  <div class="carousel-section">
    <app-learning-paths-carousel
      [learningPaths]="paths"
      [isAdmin]="isAdmin"
      (editPathEvent)="editPath($event)"
      (deletePathEvent)="deletePath($event)">
    </app-learning-paths-carousel>
  </div>

  <div *ngIf="showForm()" class="form-card" (click)="onModalClick($event)">
    <div class="form-content">
      <div class="form-header">
        <h3>{{ editMode() ? 'Edit Learning Path' : 'Add New Learning Path' }}</h3>
        <button type="button" class="close-modal" (click)="cancel()" aria-label="Close modal">
          Ã—
        </button>
      </div>

      <form #pathForm="ngForm" (ngSubmit)="savePath(pathForm)">
        <input
          type="text"
          [(ngModel)]="currentPath.title"
          name="title"
          placeholder="Title"
          required
          #title="ngModel"
          (keydown)="onKeyDown($event)"
        />

        <textarea
          [(ngModel)]="currentPath.description"
          name="description"
          placeholder="Description"
          rows="3">
        </textarea>

        <input
          type="text"
          [(ngModel)]="currentPath.estimatedHours"
          name="estimatedHours"
          placeholder="Estimated Hours"
        />

        <input
          type="text"
          [(ngModel)]="currentPath.image"
          name="image"
          placeholder="Image URL"
        />

        <div class="courses-list">
          <h4>Select Courses</h4>
          <div
            class="course-item"
            *ngFor="let c of allCourses; trackBy: trackById">
            <label>
              <input
                type="checkbox"
                [checked]="isCourseSelected(c.id)"
                (change)="toggleCourseSelection(c.id)" />
              {{ c.title }} ({{ c.duration }}h, {{ c.theme }})
            </label>
          </div>
        </div>

        <div class="form-actions">
          <button type="submit" [disabled]="pathForm.invalid" class="save-btn">Save</button>
          <button type="button" class="cancel-btn" (click)="cancel()">Cancel</button>
        </div>
      </form>
    </div>
  </div>
</div>
