<div class="register-container">
  <div class="register-card">
    <h2>Create Your Account</h2>

    <div class="alert alert-danger" *ngIf="errorMessage">{{ errorMessage }}</div>
    <div class="alert alert-success" *ngIf="successMessage">{{ successMessage }}</div>

    <form [formGroup]="registerForm" (ngSubmit)="onSubmit()">
      <!-- Name -->
      <div class="form-group">
        <label for="name">Full Name</label>
        <input id="name" type="text" formControlName="name" class="form-control"
          [class.is-invalid]="registerForm.get('name')?.invalid && registerForm.get('name')?.touched" />
        <div class="invalid-feedback" *ngIf="registerForm.get('name')?.invalid && registerForm.get('name')?.touched">
          Full name is required.
        </div>
      </div>

      <!-- Email -->
      <div class="form-group">
        <label for="email">Email</label>
        <input id="email" type="email" formControlName="email" class="form-control"
          [class.is-invalid]="registerForm.get('email')?.invalid && registerForm.get('email')?.touched" />
        <div class="invalid-feedback" *ngIf="registerForm.get('email')?.invalid && registerForm.get('email')?.touched">
          <span *ngIf="registerForm.get('email')?.errors?.['required']">Email is required.</span>
          <span *ngIf="registerForm.get('email')?.errors?.['email']">Please enter a valid email.</span>
        </div>
      </div>

      <!-- Password -->
      <div class="form-group">
        <label for="password">Password</label>
        <input id="password" type="password" formControlName="password" class="form-control"
          [class.is-invalid]="registerForm.get('password')?.invalid && registerForm.get('password')?.touched" />
        <div class="invalid-feedback" *ngIf="registerForm.get('password')?.invalid && registerForm.get('password')?.touched">
          <span *ngIf="registerForm.get('password')?.errors?.['required']">Password is required.</span>
          <span *ngIf="registerForm.get('password')?.errors?.['minlength']">Minimum 6 characters.</span>
        </div>
      </div>

      <!-- Confirm Password -->
      <div class="form-group">
        <label for="confirmPassword">Confirm Password</label>
        <input id="confirmPassword" type="password" formControlName="confirmPassword" class="form-control"
          [class.is-invalid]="registerForm.get('confirmPassword')?.invalid && registerForm.get('confirmPassword')?.touched" />
        <div class="invalid-feedback" *ngIf="registerForm.get('confirmPassword')?.invalid && registerForm.get('confirmPassword')?.touched">
          <span *ngIf="registerForm.get('confirmPassword')?.errors?.['required']">Please confirm your password.</span>
          <span *ngIf="registerForm.get('confirmPassword')?.errors?.['passwordMismatch']">Passwords do not match.</span>
        </div>
      </div>

      <!-- Department -->
      <div class="form-group">
        <label for="department">Department / Role (Optional)</label>
        <input id="department" type="text" formControlName="department" class="form-control" placeholder="e.g. Engineering, HR" />
      </div>

      <!-- LGPD Checkbox -->
      <div class="form-group terms">
        <label>
          <input type="checkbox" formControlName="acceptedTerms" />
          I have read and accept the
          <a href="#" (click)="openPrivacyPolicy($event)">Privacy Policy (LGPD)</a>.
        </label>
        <div class="invalid-feedback" *ngIf="registerForm.get('acceptedTerms')?.invalid && registerForm.get('acceptedTerms')?.touched">
          You must accept the privacy policy.
        </div>
      </div>

      <button type="submit" class="btn-register" [disabled]="registerForm.invalid || isSubmitting">
        <span *ngIf="!isSubmitting">Sign Up</span>
        <span *ngIf="isSubmitting">Creating account...</span>
      </button>
    </form>

    <div class="login-link">
      <button class="btn btn-secondary" (click)="goToLogin()">‚Üê Back to Login</button>
    </div>
  </div>

  <!-- LGPD MODAL -->
  <div class="privacy-modal" *ngIf="showPrivacyModal">
    <div class="privacy-overlay" (click)="closePrivacyPolicy()"></div>
    <div class="privacy-content">
      <h3>Privacy Policy (LGPD)</h3>
      <div class="privacy-text">
        <p><strong>1. Introduction</strong><br>
        Ford Training Hub values the privacy and protection of users' personal data. This Privacy Policy was developed in compliance with Law No. 13,709/2018 ‚Äì General Law for Personal Data Protection (LGPD), with the purpose of informing how we collect, use, store and protect the information of employees and administrators who use the platform.</p>

        <p><strong>2. Collected Data</strong><br>
        Full name, Corporate email, Position and department (when applicable), Accessed and completed courses, Training progress, Evaluations and issued certificates, IP address and device information.</p>

        <p><strong>3. Purpose of Data Processing</strong><br>
        Manage access, issue certificates, comply with legal obligations and improve user experience.</p>

        <p><strong>4. Data Sharing</strong><br>
        We do not share personal data with third parties, except in legal or operational cases necessary for system operation.</p>

        <p><strong>5. Storage and Security</strong><br>
        We use encryption, access control and protected servers to ensure information security.</p>

        <p><strong>6. User Rights</strong><br>
        The user may request access, correction, deletion or portability of their data by sending an email to:
        <strong>üìß privacy&#64;fordtraininghub.com</strong></p>
      </div>

      <button class="btn-close" (click)="closePrivacyPolicy()">Close</button>
    </div>
  </div>
</div>